<!-- eventos.html -->

<div style="display: flex; height: 100vh; font-family: Arial, sans-serif;">

  <!-- Panel izquierdo con logo -->
  <div style="width: 30%; background-color: #e0f2e9; display: flex; align-items: center; justify-content: center;">
    <img src="assets/LogoLestoma.jpg" alt="Logo" style="max-width: 80%; max-height: 80%;">
  </div>

  <!-- Panel derecho con tabla y formulario -->
  <div style="width: 70%; padding: 40px; background-color: #f9f9f9; overflow-y: auto;">
    <div style="background-color: white; border-radius: 10px; padding: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">

      <h2 style="text-align: center; margin-bottom: 20px;">Gestión de Eventos</h2>

      <!-- Tabla -->
      <table border="1" width="100%" style="border-collapse: collapse; text-align: center;">
        <thead style="background-color: #4CAF50; color: white;">
          <tr>
            <th>N°</th>
            <th>Dispositivo</th>
            <th>Impacto</th>
            <th>Sistema</th>
            <th>Fecha</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let evento of listaEventos(); let i = index">
            <td>{{ i + 1 }}</td>
            <td>{{ evento.IdDispositivo }}</td>
            <td>{{ evento.IdImpacto }}</td>
            <td>{{ evento.IdSistema }}</td>
            <td>{{ evento.FechaEvento }}</td>
            <td>
              <button (click)="seleccionarEvento(evento)">Editar</button>
              <button (click)="eliminarEvento(evento.IdEvento)">Eliminar</button>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Formulario de edición/agregado -->
      <div *ngIf="eventoSeleccionado()" style="margin-top: 30px;">
        <h3 style="margin-bottom: 10px;">
          {{ eventoSeleccionado()?.IdEvento ? 'Editar Evento' : 'Agregar Evento' }}
        </h3>
        <form (ngSubmit)="eventoSeleccionado()?.IdEvento ? modificarEvento(eventoSeleccionado()!) : agregarEvento(eventoSeleccionado()!)">
          <label>Dispositivo: <input [(ngModel)]="eventoSeleccionado()!.IdDispositivo" name="dispositivo" required></label><br><br>
          <label>Impacto: <input [(ngModel)]="eventoSeleccionado()!.IdImpacto" name="impacto" required></label><br><br>
          <label>Sistema: <input [(ngModel)]="eventoSeleccionado()!.IdSistema" name="sistema" required></label><br><br>
          <label>Fecha: <input [(ngModel)]="eventoSeleccionado()!.FechaEvento" name="fecha" type="date" required></label><br><br>
          <button type="submit">Guardar</button>
          <button type="button" (click)="eventoSeleccionado.set(null)">Cancelar</button>
        </form>
      </div>

      <div style="text-align: center; margin-top: 20px;">
        <button style="padding: 10px 30px; font-size: 16px;" (click)="eventoSeleccionado.set({ IdEvento: '', IdDispositivo: '', IdImpacto: '', IdSistema: '', FechaEvento: '' })">
          Agregar Evento
        </button>
      </div>

    </div>
  </div>
</div>
