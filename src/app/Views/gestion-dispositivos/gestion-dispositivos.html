<div class="gestion-container">
  <h2>GestiÃ³n de Dispositivos</h2>

  <!-- ðŸ”½ Barra de bÃºsqueda -->
  <div class="buscador">
    <input 
      type="text" 
      placeholder="Buscar por nombre, sistema o estado..."
      [(ngModel)]="terminoBusqueda"
      (input)="aplicarFiltros()">
  </div>

  <!-- ðŸ”½ Filtro por tipo de dispositivo -->
  <div class="filtro">
    <label for="dispositivoFiltro">Tipo de Dispositivo:</label>
    <select id="dispositivoFiltro" [(ngModel)]="tipoSeleccionado" (change)="aplicarFiltros()">
      <option value="Todos">Todos</option>
      <option *ngFor="let tipo of deviceTypes" [value]="tipo.nombre">
        {{ tipo.nombre }}
      </option>
    </select>
  </div>

  <!-- ðŸ”½ Tabla de dispositivos -->
  <table class="tabla-dispositivos">
    <thead>
      <tr>
        <th>NÂ°</th>
        <th>Nombre</th>
        <th>Sistema</th>
        <th>Estado</th>
        <th>Tipo de Dispositivo</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let dispositivo of dispositivosFiltrados; let i = index"
          (click)="seleccionarDispositivo(dispositivo)"
          [class.selected]="dispositivo === dispositivoSeleccionado">
        <td>{{ i + 1 }}</td>
        <td>{{ dispositivo.nombre }}</td>
        <td>{{ dispositivo.idSistemaNavigation?.nombre || '-' }}</td>
        <td>
          <span 
            [ngClass]="{
              'estado-on': dispositivo.idEstadoDispositivoNavigation?.nombre === 'ON', 
              'estado-off': dispositivo.idEstadoDispositivoNavigation?.nombre === 'OFF'
            }">
            {{ dispositivo.idEstadoDispositivoNavigation?.nombre || '-' }}
          </span>
        </td>
        <td>{{ dispositivo.idTipoDispositivoNavigation?.nombre || '-' }}</td>
      </tr>
    </tbody>
  </table>

  <!-- ðŸ”½ Modal -->
  <div class="modal" *ngIf="mostrarModal">
    <div class="modal-content">
      <span class="close" (click)="cerrarModal()">&times;</span>
      <h3>InformaciÃ³n del Dispositivo</h3>
      <p><strong>ID:</strong> {{ dispositivoSeleccionado?.idDispositivo }}</p>
      <p><strong>Nombre:</strong> {{ dispositivoSeleccionado?.nombre }}</p>
      <p><strong>Sistema:</strong> {{ dispositivoSeleccionado?.idSistemaNavigation?.nombre }}</p>
      <p><strong>Tipo:</strong> {{ dispositivoSeleccionado?.idTipoDispositivoNavigation?.nombre }}</p>
      <p><strong>Estado:</strong> {{ dispositivoSeleccionado?.idEstadoDispositivoNavigation?.nombre }}</p>
    </div>
  </div>
</div>
